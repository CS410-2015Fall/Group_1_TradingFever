<!doctype html>
<html>
	<head>
		<!-- Loading Libraries-->
		<script src="externalLibrary/d3/d3.min.js"></script>
		<script src="externalLibrary/jquery.min.js"></script>
		<script src="externalLibrary/bootstrap/js/bootstrap.min.js"></script>
		<script src="externalLibrary/resizer/jquery.resize.js"></script>
		<script src="externalLibrary/sweetalert-master/dist/sweetalert.min.js"></script>
		
		<link rel="stylesheet" href="externalLibrary/bootstrap/css/bootstrap.min.css">

		<!--link rel="stylesheet" href="externalLibrary/jquerymobile/jquery.mobile-1.4.5.min.css"-->
		<!--script src="externalLibrary/jquerymobile/jquery.mobile-1.4.5.min.js"></script-->

		<script src="js/modal.js"></script>
		<link rel="stylesheet" href="css/index.css">
		<link rel="stylesheet" href="externalLibrary/sweetalert-master/dist/sweetalert.css" />

		<script src="class/Stocks.js"></script>
		<script src="class/Avatar.js"></script>
		<script src="class/Login.js"></script>
		<script src="class/Investment.js"></script>
		<script src="class/StartUp.js"></script>
		<script src="class/RealEstate.js"></script>
		<script src="class/LotteryTicket.js"></script>
		<script src="class/LoanSharks.js"></script>
		<script src="class/NigerianPrince.js"></script>
		<script src="class/Bitcoin.js"></script>
		<script src="class/HedgeFund.js"></script>
		<script src="js/UIControl/index.js"></script>
		<script src="json/listofInvestments.json"></script>
		<script src="js/UIControl/InvestmentPage.js"></script>
		<script src="js/UIComponent/investmentItemDisplay.js"></script>

		<script src="class/callback.js"></script>
		<!--script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script-->

		<title>Trading Fever</title>
		<style>

		#showReturn {
	    	border-radius: 1em;
	    	background: #000000;
	    	padding: 0.25em; 
	    	width: 20em;
	    	height: 2em;    
	    	margin-left: auto;
	   	 	margin-right: auto;
		}	


		svg {
			font: 10px sans-serif;
		}

		.line {
			fill: none;
			stroke: #000;
			stroke-width: 1.5px;
		}

		.axis path,
		.axis line {
			fill: none;
			stroke: #000;
			shape-rendering: crispEdges;
		}
		</style>
	</head>
	<body style="font-size:5vmin;">
		<script>
			theAvatar = new Avatar("Daniel");
			theAvatar.setID(48927123);
			theAvatar.setCashAmount(10000);
			theAvatar.setRage(100);
			
			theStocks = new Stocks();
		</script>
		
		<div class="modal fade" id="profileModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title">Profile</h4>
					</div>
					
					<div class="modal-body">
						<table><tr>
							<td>
								<img id="avatarPicture_modal" src="img/profile_empty.jpg" style="width:5em"/><br />
								<input type="file" accept="image/*" style="width:5em;" onchange="gotImage(this)"/>
							</td>
							<td><table>
								<tr><td id="avatarName_modal">(Name)</td></tr>
								<tr><td>Networth:$<span id="avatarNetworth_modal">(Networth)</span></td></tr>
							</table></td>
						</tr></table>
					</div>
					
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
						<button type="button" class="btn btn-primary">Save changes</button>
					</div>
				</div>
			</div>
		</div>
		<script>
			function gotImage(theImage){
				if (theImage.files && theImage.files[0]) {
					var reader = new FileReader();
					var resultImageData = 0;

					reader.onload = function (e) {
						resultImageData = e.target.result;
						document.getElementById('avatarPicture_modal').src =  resultImageData;
						
						console.log(resultImageData);
						
						// save to local storage
						localStorage.setItem("profilePicture", resultImageData);
					
						// load from local storage
						document.getElementById('avatarPicture').src = localStorage.getItem('profilePicture');
					}
					reader.readAsDataURL(theImage.files[0]);
				}
			}
		</script>
		
		<div id="statusBar" style="height:10vh; background-color:black">
			<table style="width:100%; height:100%"><tr>
				<!--td><table data-toggle="modal" data-target="#profileModal"><tr-->
				<td><table data-toggle="modal" onclick="$('#profileModal').modal()"><tr>
					<td id="avatarPictureHolder">
						<img id="avatarPicture" src="img/profile_empty.jpg" style="height:1.8em"/>
					</td>
					<td id="avatarInfo" style="height:100%">
						<div id="avatarName_display" style="color:white;">
							(Name)
						</div>
					</td>
				</tr></table></td>
				<td id="avatarCash_display" style="height:100%; color:white; text-align:right">
					(Cash Amount)
				</td>
				
			</tr></table>
		</div>
		
		<div class="bs-example bs-example-tabs" data-example-id="togglable-tabs" id="gameTabWidget">
			<ul id="gameTabs" class="nav nav-tabs" role="tablist">
				<li role="presentation" class="active">
					<a href="#gameHome" id="game-home-tab" role="tab" data-toggle="tab" aria-controls="home" aria-expanded="true">Home</a>
				</li>
				<li role="presentation" class="">
					<a href="#stockPage" role="tab" id="stockPage-tab" data-toggle="tab" aria-controls="profile" aria-expanded="false">Stock</a>
				</li>
				<li role="presentation" class="">
					<a href="#investmentPage" role="tab" id="investmentPage-tab" data-toggle="tab" aria-controls="profile" aria-expanded="false">Investments</a>
				</li>
			</ul>
			<div id="myTabContent" class="tab-content">
				<div role="tabpanel" class="tab-pane active in" id="gameHome" aria-labelledby="game-home-tab">
					<!--p>Content for home page goes here</p-->
					<!--img src="img/room.jpg" style="width:100%; height:80vh"/-->
					<fb:login-button autologoutlink="true" scope="public_profile,email,user_friends" onlogin="checkLoginState();"></fb:login-button>
					<script>
						theAvatar.updateRemoteCash();
						theAvatar.setCashAmount(5000);

						function updateDatabase(){
							theAvatar.setRemoteCash();
							console.log("update remote cash");
						}
						setInterval(updateDatabase,1000);
					</script>
					<div id="status"></div>
					<button class="btn" style="width:20%" onclick="post()">post to facebook</button>
				</div>
				<div role="tabpanel" class="tab-pane" id="stockPage" aria-labelledby="stockPage-tab">
					<p>
						<p id="showReturn" style="font-size:1em" align="center"></p>


						<div id = "stocks"></div>
						<table style="width:100%">
							<tr>
								<td><button id = 'buybutton' style="background-color:lightgreen">Buy 100 shares</button></td>
								
								<td><button id = 'sellbutton' style="background-color:red">Sell 100 shares</button></td> 
							</tr>
							
						</table>

						<div id="stockPrice"></div>

						<div id="netLiquidation"></div>

						<div id="shares"></div>

						<div id="securitiesGPV"></div>

						<div id="cash"></div>

						<div id="availableFunds"></div>

						<div id="leverage"></div>

						<div id="transactionFee"></div>
						<table style = "width:100%">
							<tr>
								<td><button id = 'outbutton'>Transfer $10k out</button></td>
								<td><button id = 'inbutton'>Transfer $10k in</button></td>

							</tr>
						</table>

					</p>
				</div>
				<div role="tabpanel" class="tab-pane" id="investmentPage" aria-labelledby="investmentPage-tab" href="#investments"></div>
			</div>
		</div>
			<!--button class="btn" href="#investment1" onclick='overlay()'>Tech Startup</button-->
		
		
		<script>
		/*
			$(document).ready(function(){
				document.getElementById("gameTabWidget").style.height = "" + $(window).height() + "px";
				$(window).resize(function(){
					var currentWindowHeight = $(window).height();
					var currentWindowWidth = $(window).width();
					
					// resize gameTabWidget
					document.getElementById("gameTabWidget").style.height = "" + currentWindowHeight + "px";
				})
			});
		*/
		
		
		
		/*
		<div id="investment1" class="overlay">
		    <div>
		        <p>Daniel has a startup idea and needs you to invest $2000.</p>
		        <button class="option floated" href="" onclick='overlay();invest()' style="width:160px">invest $2000</button>
				<button class="option floated" href="" onclick='overlay()'>close</button>
		     </div>
		</div>
		*/
		</script>
		
		<script>
			var aLotteryTicket = new LotteryTicket();
			console.log(aLotteryTicket);
			aLotteryTicket.setPotentialReturn(100);
			aLotteryTicket.setInvestmentTitle('Lotto 649');
			aLotteryTicket.setDescription('A ticket to prosperity');
			theAvatar.addInvestmentInstance(aLotteryTicket);
			//theAvatar.upgradeInvestment(aLotteryTicket);
			aLotteryTicket.setImgURL('img/lotto.jpg');
		
			var aLoanShark = new LoanSharks();
			console.log(aLoanShark);
			aLoanShark.setPotentialReturn(100);
			aLoanShark.setInvestmentTitle('Loan Sharks');
			aLoanShark.setDescription("A new acquaintance offers to help invest your extra cash");
			theAvatar.addInvestmentInstance(aLoanShark);
			//theAvatar.upgradeInvestment(aLoanShark);
			aLoanShark.setImgURL('img/loanshark.jpg');

			var aNigerianPrince = new NigerianPrince();
			console.log(aNigerianPrince);
			aNigerianPrince.setPotentialReturn(100);
			aNigerianPrince.setInvestmentTitle('Nigerian Email');
			aNigerianPrince.setDescription("Dear Sir: I have been requested by the Nigerian National Petroleum Company to contact you for assistance in resolving a matter.\n Yours truly, \n" + "\nPrince Alyusi Islassis");
			theAvatar.addInvestmentInstance(aNigerianPrince);
			//theAvatar.upgradeInvestment(aNigerianPrince);
			aNigerianPrince.setImgURL('img/nigerian.png');

			var aStartUp = new StartUp();
			aStartUp.setPotentialReturn(100);
			aStartUp.setInvestmentTitle('Daniel Inc.');
			aStartUp.setDescription("Your friend's startup is certainly the next big thing");
			theAvatar.addInvestmentInstance(aStartUp);
			//theAvatar.upgradeInvestment(aStartUp);
			aStartUp.setImgURL('img/daniel.jpg');
			
			var aRealEstate = new RealEstate();
			aRealEstate.setMonthlyReturn(10);
			aRealEstate.setInvestmentTitle('Prime Real Estate');
			aRealEstate.setDescription('A pricey piece of property');
			theAvatar.addInvestmentInstance(aRealEstate);
			//theAvatar.upgradeInvestment(aRealEstate);
			aRealEstate.setImgURL('img/realestate.jpg');

			var aBitcoin = new Bitcoin();
			console.log(aBitcoin);
			aBitcoin.setPotentialReturn(100);
			aBitcoin.setInvestmentTitle('Virtual Currencies');
			aBitcoin.setDescription("Clearly, the end of fiat currency is here.");
			theAvatar.addInvestmentInstance(aBitcoin);
			//theAvatar.upgradeInvestment(aBitcoin);
			aBitcoin.setImgURL('img/bitcoin.jpg');

			var aHedgeFund = new HedgeFund();
			console.log(aHedgeFund);
			aHedgeFund.setPotentialReturn(100);
			aHedgeFund.setInvestmentTitle('Investment Fund');
			aHedgeFund.setDescription("Your investment advisor tells you to invest with a secure investment fund run by a jolly old man. He's been on Wall Street for decades-what could go wrong?");
			theAvatar.addInvestmentInstance(aHedgeFund);
			//theAvatar.upgradeInvestment(aHedgeFund);
			aHedgeFund.setImgURL('img/scheme.jpg');
			
			mkInvestmentPage();
		</script>
		
		<script>
			initialLoad();
			function callRefreshStatusBar(){
				refreshStatusBar(theAvatar);
			}
			setInterval(callRefreshStatusBar,100); // calls callRefreshStatusBar() every 0.1 seconds
			

		</script>
		
		<script src = "class/Simulation.js"></script>
	</body>
</html>